{"file":"je-tree.js","mappings":"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","names":["JeTree","__stencil_proxyCustomElement","HTMLElement"],"sources":["src/components/je-tree/je-tree.css?tag=je-tree&encapsulation=shadow","src/components/je-tree/je-tree.tsx"],"sourcesContent":[":host {\n  display: block;\n  box-sizing: border-box;\n}\n","import { Component, Element, Event, EventEmitter, Host, Listen, Prop, Watch, h } from '@stencil/core';\n\n@Component({\n  tag: 'je-tree',\n  styleUrl: 'je-tree.css',\n  shadow: true,\n})\nexport class JeTree {\n  @Element() element: HTMLJeTreeElement;\n  @Prop({ mutable: true }) value?: string | string[];\n  @Prop() selection: 'single' | 'multiple' | 'leaf' = 'leaf';\n  @Prop() indentation = false;\n  @Event() valueChange: EventEmitter<string | string[]>;\n\n  private get branches() {\n    return Array.from(this.element.querySelectorAll('je-branch'))\n  }\n\n  componentWillLoad() {\n    if (this.selection == 'multiple' && !Array.isArray(this.value)) this.value = [];\n  }\n\n  componentWillRender() {\n    const { branches, selection, indentation, value } = this;\n    branches.forEach(branch => {\n      branch.selection = selection;\n      branch.indentation = indentation;\n    })\n    const selectedBranch = branches.find(b => value == (b.value ?? b.label))\n    if (selectedBranch && !selectedBranch.selected) {\n      this.onClick({target: selectedBranch} as any)\n    }\n  }\n\n  @Watch('value')\n  valueChanged() {\n    this.valueChange.emit(this.value);\n  }\n\n  @Listen('click')\n  async onClick(event: MouseEvent) {\n    const { target } = event;\n    if (this.isBranch(target)) {\n      const { branches, selection } = this;\n      const isLeaf = await target.isLeaf();\n      if ((selection == 'leaf' && isLeaf) || selection == 'single') {\n        this.value = target.value || target.label;\n        branches.forEach(branch => branch.selected = this.value === (branch.value || branch.label));\n      } else if (this.selection == 'leaf') {\n        target.open = !target.open;\n      } else if (this.selection == 'multiple') {\n        target.selected = !target.selected;\n        if (isLeaf && target.selected) {\n          this.value = [...this.value, (target.value || target.label)]\n        } else if (isLeaf) {\n          this.value = (this.value as Array<string>).filter(v => v != (target.value || target.label))\n        } else {\n          target.querySelectorAll('je-branch').forEach(branch => branch.selected = target.selected);\n        }\n        this.setParents(target);\n      }\n    }\n  }\n\n  @Listen('keyup')\n  async onKeyup(event: KeyboardEvent) {\n    const { target, key } = event;\n    if (this.isBranch(target)) {\n      const hasChildren = !(await target.isLeaf());\n      const { branches } = this;\n      if (key == 'ArrowRight' && hasChildren && !target.open) {\n        target.open = true;\n      } else if (key == 'ArrowLeft' && hasChildren && target.open) {\n        target.open = false;\n      } else if (key == 'ArrowUp') {\n        const index = branches.indexOf(target);\n        if (index > 0) {\n          branches[index - 1].focus();\n        }\n      } else if (key == 'ArrowDown') {\n        const index = branches.indexOf(target);\n        if (index < branches.length - 1) {\n          branches[index + 1].focus();\n        }\n      }\n    }\n  }\n\n  private isBranch = (target: any): target is HTMLJeBranchElement => target instanceof HTMLElement && target.tagName == 'JE-BRANCH';\n\n  private async setParents(branch: HTMLJeBranchElement) {\n    const parentBranch = branch.parentElement\n    if (this.isBranch(parentBranch)) {\n      const children = Array.from(parentBranch.querySelectorAll('je-branch'));\n      parentBranch.selected = children.every(child => child.selected) ? true : children.some(child => child.selected) ? null : false;\n      this.setParents(parentBranch);\n    }\n  }\n\n  render() {\n    return (\n      <Host>\n        <slot></slot>\n      </Host>\n    );\n  }\n}\n"],"version":3}